<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç‹ç‹¸æ§åˆ¶å°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #c8f5f5 0%, #a8e6e6 25%, #88d7d7 50%, #68c8c8 75%, #48b9b9 100%);
            font-family: "Comic Sans MS", "Microsoft YaHei", sans-serif;
            color: #444;
            min-height: 100vh;
            display: flex;
        }

        /* ä¾§è¾¹æ æ ·å¼ */
        .sidebar {
            width: 280px;
            background: linear-gradient(145deg, #dceafe, #c8e0fa);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 100;
        }

        .sidebar-header {
            padding: 30px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }

        .sidebar-header .fox {
            font-size: 60px;
            margin-bottom: 10px;
            animation: bounce 0.8s infinite alternate;
        }

        .sidebar-header h1 {
            color: #5210ed;
            font-size: 20px;
            background: linear-gradient(45deg, #5210ed, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-menu {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
        }

        .nav-item {
            padding: 15px 25px;
            margin: 5px 15px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #666;
            text-decoration: none;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.6);
            transform: translateX(5px);
            color: #5210ed;
        }

        .nav-item.active {
            background: linear-gradient(45deg, #110d77, #5210ed);
            color: white;
            box-shadow: 0 4px 15px rgba(82, 16, 237, 0.3);
        }

        .nav-item .icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .nav-item .text {
            font-size: 16px;
            font-weight: 500;
        }

        /* ä¸»å†…å®¹åŒºæ ·å¼ */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 30px;
            min-height: 100vh;
        }

        .content-header {
            background: linear-gradient(145deg, #dceafe, #c8e0fa);
            padding: 25px 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .content-header h2 {
            color: #5210ed;
            font-size: 28px;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #5210ed, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .content-body {
            background: linear-gradient(145deg, #dceafe, #c8e0fa);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            min-height: 500px;
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes bounce {
            from {
                transform: translateY(0);
            }

            to {
                transform: translateY(-5px);
            }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }

            .sidebar-header h1,
            .nav-item .text {
                display: none;
            }

            .main-content {
                margin-left: 70px;
            }
        }
        .dashboard-grid {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.metric-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.metric-card {
    background: rgba(255, 255, 255, 0.95);
    padding: 25px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.3);
    display: flex;
    align-items: center;
    gap: 15px;
    transition: all 0.3s ease;
}

.metric-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(0, 0, 0, 0.12);
}

.metric-card.small {
    padding: 20px;
    text-align: center;
    justify-content: center;
}

.metric-icon {
    font-size: 32px;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #5210ed, #8b5cf6);
    border-radius: 12px;
    color: white;
}

.metric-content {
    flex: 1;
}

.metric-value {
    font-size: 28px;
    font-weight: bold;
    color: #5210ed;
    margin-bottom: 5px;
}

.metric-label {
    font-size: 14px;
    color: #666;
    font-weight: 500;
}

.refresh-section {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.3);
}

.refresh-btn {
    background: linear-gradient(135deg, #5210ed, #8b5cf6);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
}

.refresh-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(82, 16, 237, 0.3);
}

.refresh-icon {
    font-size: 16px;
}

.last-update {
    font-size: 14px;
    color: #666;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .metric-row {
        grid-template-columns: 1fr;
    }
    
    .refresh-section {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
    }
}
    </style>
</head>

<body>
    <!-- ä¾§è¾¹å¯¼èˆªæ  -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="fox">ğŸ¦Š</div>
            <h1>å°ç‹ç‹¸æ§åˆ¶å°</h1>
        </div>

        <div class="nav-menu">
            <a href="javascript:void(0)" class="nav-item active" data-page="dashboard">
                <span class="icon">ğŸ“Š</span>
                <span class="text">æ•°æ®æ¦‚è§ˆ</span>
            </a>
            <a href="javascript:void(0)" class="nav-item" data-page="acl">
                <span class="icon">ğŸ›¡ï¸</span>
                <span class="text">ACLè§„åˆ™</span>
            </a>
            <a href="javascript:void(0)" class="nav-item" data-page="cache">
                <span class="icon">âš¡</span>
                <span class="text">ç¼“å­˜ç®¡ç†</span>
            </a>
            <a href="javascript:void(0)" class="nav-item" data-page="sites">
                <span class="icon">ğŸŒ</span>
                <span class="text">ç«™ç‚¹ç®¡ç†</span>
            </a>
            <a href="javascript:void(0)" class="nav-item" data-page="logs">
                <span class="icon">ğŸ“</span>
                <span class="text">æ”»å‡»æ—¥å¿—</span>
            </a>
            <a href="javascript:void(0)" class="nav-item" data-page="settings">
                <span class="icon">âš™ï¸</span>
                <span class="text">ç³»ç»Ÿè®¾ç½®</span>
            </a>
        </div>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content">
        <div class="content-header">
            <h2 id="page-title">æ•°æ®æ¦‚è§ˆ</h2>
            <p id="page-description">æ¬¢è¿æ¥åˆ°å°ç‹ç‹¸WAFæ§åˆ¶å°</p>
        </div>

        <div class="content-body" id="content-container">
            <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            <div id="dashboard-content">
                <h3>ğŸ¦Š ç³»ç»Ÿæ¦‚è§ˆ</h3>
                <p>è¿™é‡Œæ˜¯æ•°æ®æ¦‚è§ˆé¡µé¢å†…å®¹...</p>
            </div>
        </div>
    </div>

    <script>
        // é¡µé¢å†…å®¹å®šä¹‰
        const pageContents = {
            dashboard: {
                title: "æ•°æ®æ¦‚è§ˆ",
                description: "ç³»ç»Ÿè¿è¡ŒçŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯",
                content: `
            <div class="dashboard-grid">
                <div class="metric-row">
                    <div class="metric-card">
                        <div class="metric-icon">ğŸŒ</div>
                        <div class="metric-content">
                            <div class="metric-value" id="total-requests">0</div>
                            <div class="metric-label">æ€»è¯·æ±‚æ•°</div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">ğŸ›¡ï¸</div>
                        <div class="metric-content">
                            <div class="metric-value" id="blocked-requests">0</div>
                            <div class="metric-label">æ‹¦æˆªæ”»å‡»</div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">âš¡</div>
                        <div class="metric-content">
                            <div class="metric-value" id="cache-hit-rate">0%</div>
                            <div class="metric-label">ç¼“å­˜å‘½ä¸­ç‡</div>
                        </div>
                    </div>
                </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">ğŸ“‹</div>
                        <div class="metric-content">
                            <div class="metric-value" id="total-rules">0</div>
                            <div class="metric-label">WAFè§„åˆ™</div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">ğŸŒ</div>
                        <div class="metric-content">
                            <div class="metric-value" id="total-sites">0</div>
                            <div class="metric-label">ä»£ç†ç«™ç‚¹</div>
                        </div>
                    </div>
                </div>
            </div>
        `
            },
            acl: {
                title: "ACLè§„åˆ™ç®¡ç†",
                description: "è®¿é—®æ§åˆ¶åˆ—è¡¨è§„åˆ™é…ç½®",
                content: `
                    <h3>ğŸ›¡ï¸ ACLè§„åˆ™ç®¡ç†</h3>
                    <p>è¿™é‡Œæ˜¯ACLè§„åˆ™ç®¡ç†é¡µé¢...</p>
                `
            },
            cache: {
                title: "ç¼“å­˜ç®¡ç†", 
                description: "é™æ€ç¼“å­˜é…ç½®å’Œç»Ÿè®¡",
                content: `
                    <h3>âš¡ ç¼“å­˜ç®¡ç†</h3>
                    <p>è¿™é‡Œæ˜¯ç¼“å­˜ç®¡ç†é¡µé¢...</p>
                `
            },
            sites: {
                title: "ç«™ç‚¹ç®¡ç†",
                description: "åå‘ä»£ç†ç«™ç‚¹é…ç½®",
                content: `
                    <h3>ğŸŒ ç«™ç‚¹ç®¡ç†</h3>
                    <p>è¿™é‡Œæ˜¯ç«™ç‚¹ç®¡ç†é¡µé¢...</p>
                `
            },
            logs: {
                title: "æ”»å‡»æ—¥å¿—",
                description: "æŸ¥çœ‹å’Œåˆ†ææ”»å‡»è®°å½•",
                content: `
                    <h3>ğŸ“ æ”»å‡»æ—¥å¿—</h3>
                    <p>è¿™é‡Œæ˜¯æ”»å‡»æ—¥å¿—é¡µé¢...</p>
                `
            },
            settings: {
                title: "ç³»ç»Ÿè®¾ç½®",
                description: "ç³»ç»Ÿé…ç½®å’Œå‚æ•°è°ƒæ•´",
                content: `
                    <h3>âš™ï¸ ç³»ç»Ÿè®¾ç½®</h3>
                    <p>è¿™é‡Œæ˜¯ç³»ç»Ÿè®¾ç½®é¡µé¢...</p>
                `
            }
        };

        // é¡µé¢åˆ‡æ¢åŠŸèƒ½
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                // ç§»é™¤æ‰€æœ‰activeç±»
                document.querySelectorAll('.nav-item').forEach(nav => {
                    nav.classList.remove('active');
                });
                // æ·»åŠ å½“å‰activeç±»
                this.classList.add('active');
                
                // è·å–é¡µé¢æ ‡è¯†
                const pageId = this.getAttribute('data-page');
                loadPage(pageId);
            });
        });

        // åŠ è½½é¡µé¢å†…å®¹
        function loadPage(pageId) {
            const page = pageContents[pageId];
            if (page) {
                document.getElementById('page-title').textContent = page.title;
                document.getElementById('page-description').textContent = page.description;
                document.getElementById('content-container').innerHTML = page.content;
            }
        }
    // åœ¨æ§åˆ¶å°é¡µé¢çš„JavaScriptä¸­æ·»åŠ è¿™ä¸ªå‡½æ•°
    async function loadStats() {
        try {
            const response = await fetch('/api/stats', {
                method: 'GET',
                credentials: 'include' // åŒ…å«cookie
            });

            if (response.ok) {
                const stats = await response.json();

                // æ›´æ–°é¡µé¢æ˜¾ç¤º
                document.getElementById('total-requests').textContent = stats.total_requests.toLocaleString();
                document.getElementById('blocked-requests').textContent = stats.blocked_requests.toLocaleString();
                document.getElementById('cache-hit-rate').textContent = stats.cache_hit_rate;
                document.getElementById('total-rules').textContent = stats.total_rules;
                document.getElementById('total-sites').textContent = stats.total_sites;
            } else {
                console.error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:', response.status);
            }
        } catch (error) {
            console.error('è·å–ç»Ÿè®¡æ•°æ®é”™è¯¯:', error);
        }
    }

    // ä¿®æ”¹åˆ·æ–°å‡½æ•°
        function refreshStats() {
            loadStats();
            addActivity('æ•°æ®å·²åˆ·æ–°', 'åˆšåˆš');
        }

        // ä¿®æ”¹åˆå§‹åŒ–å‡½æ•°ï¼Œæ·»åŠ å®šæ—¶åˆ·æ–°
        document.addEventListener('DOMContentLoaded', function () {
            // ç«‹å³åŠ è½½ä¸€æ¬¡æ•°æ®
            loadStats();

            // æ¯5ç§’è‡ªåŠ¨åˆ·æ–°æ•°æ®
            setInterval(loadStats, 5000);

            // æ¨¡æ‹Ÿä¸€äº›åˆå§‹æ´»åŠ¨
            setTimeout(() => addActivity('æ–°çš„ACLè§„åˆ™å·²åº”ç”¨', '1åˆ†é’Ÿå‰'), 1000);
            setTimeout(() => addActivity('ç¼“å­˜æ¸…ç†å®Œæˆ', '2åˆ†é’Ÿå‰'), 2000);
            setTimeout(() => addActivity('æ£€æµ‹åˆ°SQLæ³¨å…¥æ”»å‡»', '3åˆ†é’Ÿå‰'), 3000);
        });

        // åˆå§‹åŒ–åŠ è½½ç¬¬ä¸€ä¸ªé¡µé¢
        loadPage('dashboard');
    </script>
</body>

</html>